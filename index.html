<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>USB FEED Project by JohnMcLaren</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>USB FEED Project</h1>
        <p>USB FEED DRIVER ARMv7 / STM32 / Qt5 / C++</p>
        <p class="view"><a href="https://github.com/JohnMcLaren/USBFeedDriver">View the Project on GitHub <small>JohnMcLaren/USBFeedDriver</small></a></p>
        <ul>
          <li><a href="https://github.com/JohnMcLaren/USBFeedDriver/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/JohnMcLaren/USBFeedDriver/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/JohnMcLaren/USBFeedDriver">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
      	<h1>
<a aria-hidden="true" href="#usb-feed-driver" class="anchor" id="usb-feed-driver"><span class="octicon octicon-link"></span></a>USB FEED DRIVER</h1>

<blockquote>
<p><em>ARMv7 Cortex&trade; M3 / STM32F103</em></p>
<pre><code>									15.05.15</code></pre>
</blockquote>

<OL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Особенности драйвера и протокола</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2><B>FEED PROTOCOL</B></FONT></P>

<P STYLE="margin-left: 2.54cm; margin-bottom: 0cm; line-height: 115%;">
<FONT SIZE=2>2.1 FEED FRAME PROTOCOL</FONT></P>
<P STYLE="margin-left: 2.54cm; margin-bottom: 0cm; line-height: 115%;">
<FONT SIZE=2>2.2 FEED ADDRESS PROTOCOL</FONT></P>

	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2><B>Класс</B></FONT><FONT SIZE=2> USB Feed порта (C++ /
	Qt5)</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Тест</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2><B>терминал</B></FONT></P>
</OL>
<P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<H3 STYLE="margin-top: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto"><A NAME="h.vcd0i0b8omb3"></A>
1. Ключевые особенности FEED драйвера и протокола</H3>
<P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Устройство использующее FEED
	протокол представляется USB хосту как стандартный USB </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>CDC</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	ACM порт, поэтому для &ldquo;установки&rdquo; устройства нужен
	только </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>inf</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	файл (ОС Windows)</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Устройство </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>может</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	использовать прерывание предусмотренное USB CDC классом</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Высокая скорость передачи: 4,5
	Mbit / s. И это не предел, так как размер буфера </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>Bulk</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	точки всего 62 байта (</FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>Full
	Speed</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt"> - 12 Mbit / s),
	который может быть увеличен до максимальных 1024 допускаемых USB
	стандартом а устройство переведено в режим </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>High
	Speed</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt"> (480 Mbit / s).</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Малый размер кода драйвера
	</FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>устройства</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	~1,5 kB ( ARMv7 Cortex&trade; M3 - STM32F103 / оптимизация -O2 ).
	Драйвер </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>не использует</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	стандартных библиотек (STM32F10x_StdPeriph_Lib_Vxxx /
	STM32_USB-FS-Device_Lib_Vxxx)</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Высокое отношение размера
	полезной нагрузки к сервисной информации во фрейме.  Так например из
	</FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>255</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	байт допустимого размера фрейма, только </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>6</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	являются сервисными (2,35 %), при 31-битном адресе интерфейса и </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><B>3</B></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	(1,17 %) при 8-битном.</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Малый трафик. Минимальный размер
	фрейма 3 байта (операция </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>чтения</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	с </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>8-битного</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	адреса).</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">Большой диапазон адресов
	интерфейсов - 2 147 483 648 (31 битная адресация)</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">FEED драйвер освобождает
	разработчика устройства от необходимости изучения работы USB и
	представляет её </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>просто</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	как линию связи</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2 STYLE="font-size: 9pt">FEED протокол с минимальными
	изменениями может быть расширен на </FONT><FONT SIZE=2 STYLE="font-size: 9pt"><U>любые</U></FONT><FONT SIZE=2 STYLE="font-size: 9pt">
	другие линии связи</FONT></P>
</UL>
<UL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Целостность</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>каждого</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>фрейма</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>защищена</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2><U>CRC</U></FONT><FONT SIZE=2><U>8</U></FONT></P>
</UL>
<P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<H3 STYLE="line-height: 115%; page-break-before: auto; page-break-after: auto"><A NAME="h.8nerb41vjlwv"></A>
2. FEED PROTOCOL</H3>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Протокол</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>типа</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>точка</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2>точка</FONT><FONT SIZE=2>.
</FONT><FONT SIZE=2>Состоит</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>из</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>двух</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>логических</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>уровней</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>каждом</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>из</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>которых</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>передачу</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>обслуживает</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>протокол</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>соответствующего</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>уровня</FONT><FONT SIZE=2>. </FONT>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Уровни разделяются на:</FONT></P>
<OL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Канальный</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Транспортный</FONT></P>
</OL>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Работу</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>канальном</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>уровне</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>выполняет</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>FEED</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>FRAME</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>PROTOCOL</FONT><FONT SIZE=2>
(</FONT><FONT SIZE=2>фрейм</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>протокол</FONT><FONT SIZE=2>),
</FONT><FONT SIZE=2>а</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>транспортном</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>FEED</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>ADDRESS</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>PROTOCOL</FONT><FONT SIZE=2>
(</FONT><FONT SIZE=2>протокол</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>логической</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>адресации</FONT><FONT SIZE=2>). </FONT><FONT SIZE=2>Сетевой</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>уровень</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данном</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>этапе</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>разработки</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>протокола</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>пропущен</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>так</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>как</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>в</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>нём</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>нет</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>необходимости</FONT><FONT SIZE=2>. </FONT><FONT SIZE=2>Изначально</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>протокол</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>разрабатывался</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>для</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>осуществления</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>двунаправленной</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>передачи</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>по</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>USB</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>шине</FONT><FONT SIZE=2>,
</FONT><FONT SIZE=2>между</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>ПК</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>устройством</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>вопрос</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>объединения</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>нескольких</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>устройств</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>в</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>сеть</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>не</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>стоял</FONT><FONT SIZE=2>.</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>FEED</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>протокол</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>работает</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>поверх</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>протоколов</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>физического</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>канала</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>связи</FONT><FONT SIZE=2>.
</FONT><FONT SIZE=2>Поэтому</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>может</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>выполнять</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>свои</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>функции</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>любой</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>линии</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>связи</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>с</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>устройством</FONT><FONT SIZE=2>. </FONT><FONT SIZE=2>В</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данном</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>случае</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>в</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>роли</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>физического</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>канала</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>связи</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>выступает</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>USB</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>шина</FONT><FONT SIZE=2>,
</FONT><FONT SIZE=2>но</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>в</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>будущем</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>протокол</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>будет</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>расширен</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>другие</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>линии</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>связи</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>с</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>доработкой</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>и</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>написанием</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>соответствующих</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>драйверов</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>под</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>конкретный</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>фид</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2>канал</FONT><FONT SIZE=2>.</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>В представлении фид-канала, любое устройство
подключённое к фиду представляется в виде устройства с неограниченным
(теоретически) набором функций (интерфейсов), где фрейм-протокол
(FEED FRAME PROTOCOL) обеспечивает целостность и доставку данных </FONT><FONT SIZE=2><U>до
устройства</U></FONT><FONT SIZE=2>, а протокол логической адресации
(FEED ADDRESS PROTOCOL) предоставляет возможность дальнейшей селекции
и доставки принятых данных </FONT><FONT SIZE=2><U>к интерфейсу</U></FONT><FONT SIZE=2>
устройства.</FONT></P>
<P ALIGN=CENTER STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/FeedIFacesChannel.png"></P>
<H4>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<B>2.1 </B><B>FEED FRAME PROTOCOL</B></P></H4>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Протокол нижнего </FONT><FONT SIZE=2><U>канального</U></FONT><FONT SIZE=2>
уровня в двухуровневой модели связи фид-канала. </FONT>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>На его уровне реализуется:</FONT></P>
<OL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2><B>Формирование</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2><B>кадров</B></FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>передаваемых</FONT><FONT SIZE=2>/</FONT><FONT SIZE=2>принимаемых</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2>. </FONT><FONT SIZE=2>Передаваемые</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>данные</FONT><FONT SIZE=2>, </FONT><FONT SIZE=2>если</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>их</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>длина</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>превышает</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>максимальный</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>допустимый</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>размер</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>, </FONT><FONT SIZE=2>разбиваются</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>на</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>кадры</FONT><FONT SIZE=2>
	(</FONT><FONT SIZE=2>фреймы</FONT><FONT SIZE=2>) </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>передающей</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>стороне</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>собираются</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>из</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>кадров</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>на</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>приемной</FONT><FONT SIZE=2>.</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2><B>Контроль</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2><B>длины</B></FONT><FONT SIZE=2><B>
	</B></FONT><FONT SIZE=2><B>и</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2><B>целостности</B></FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>. </FONT><FONT SIZE=2>Длина</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>указывается</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>в</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>заголовке</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>и</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>занимает</FONT><FONT SIZE=2> 1 </FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>от</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>общей</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>длины</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>.
	</FONT><FONT SIZE=2>Контрольная</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>сумма</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>также</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>занимает</FONT><FONT SIZE=2> 1 </FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>является</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>последним</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>байтом</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>.</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2><B>Сброс</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2>приёмного</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>буфера</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>устройства</FONT><FONT SIZE=2>.</FONT></P>
</OL>
<P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/FeedFrameStruct.png"></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2><B>В</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2><B>заголовке</B></FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>при</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>передаче</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>записывается</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>полная</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>длина</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> (</FONT><FONT SIZE=2>включая</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>заголовка</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>контрольной</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>суммы</FONT><FONT SIZE=2>).
</FONT><FONT SIZE=2>При</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>приёме</FONT><FONT SIZE=2>,
</FONT><FONT SIZE=2>приёмный</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>буфер</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>заполняется</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>приходящими</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данными</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>пока</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>в</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>него</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>не</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>будет</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>считано</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>указанное</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>в</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>заголовке</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>количество</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2>.
</FONT><FONT SIZE=2>После</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>приёма</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>заявленного</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>в</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>заголовке</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>количества</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2>,
</FONT><FONT SIZE=2>выполняется</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>проверка</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>контрольной</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>суммы</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>. </FONT>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2><B>Контрольная</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2><B>сумма</B></FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>рассчитывается</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>побайтно</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>для</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2><U>заголовка</U></FONT><FONT SIZE=2><U> </U></FONT><FONT SIZE=2><U>и</U></FONT><FONT SIZE=2><U>
</U></FONT><FONT SIZE=2><U>данных</U></FONT><FONT SIZE=2><U> </U></FONT><FONT SIZE=2><U>кадра</U></FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>и</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>является</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>их</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>инвертированной</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>суммой</FONT><FONT SIZE=2> (</FONT><FONT SIZE=2>по</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>модулю</FONT><FONT SIZE=2> 256), </FONT><FONT SIZE=2>т</FONT><FONT SIZE=2>.</FONT><FONT SIZE=2>е</FONT><FONT SIZE=2>.
</FONT><FONT SIZE=2>если</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>приёмной</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>стороне</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>провести</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>подобную</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>операцию</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>вычисления</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>контрольной</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>суммы</FONT><FONT SIZE=2>,
</FONT><FONT SIZE=2><U>включая</U></FONT><FONT SIZE=2> </FONT><FONT SIZE=2>сам</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>контрольной</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>суммы</FONT><FONT SIZE=2>, </FONT><FONT SIZE=2>результат</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>при</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>безошибочной</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>передаче</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>должен</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>быть</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>равен</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>нулю</FONT><FONT SIZE=2>.</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2><B>Исключительной</B></FONT><FONT SIZE=2> </FONT><FONT SIZE=2>ситуацией</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>является</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>нулевая</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>длина</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2>.
</FONT><FONT SIZE=2>В</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>таком</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>случае</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>выполняется</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>сброс</FONT><FONT SIZE=2>/</FONT><FONT SIZE=2>очистка</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2><U>приёмного</U></FONT><FONT SIZE=2> </FONT><FONT SIZE=2>буфера</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>фид</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2>канала</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>устройства</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>с</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>потерей</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>всех</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>принятых</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>включая</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>буфер</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>приёма</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>физического</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>уровня</FONT><FONT SIZE=2> (</FONT><FONT SIZE=2>в</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данном</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>случае</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>PMA</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2>буфер</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>USB</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>модуля</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>микроконтроллера</FONT><FONT SIZE=2>). </FONT>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>При</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>не</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>совпадении</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>вычисленной</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>контрольной</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>суммы</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>кадра</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>с</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>указанной</FONT><FONT SIZE=2>, </FONT><FONT SIZE=2>драйвер</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>фид</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2>канала</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>выставляет</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>флаг</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2><B>FRAME</B></FONT><FONT SIZE=2><B>_</B></FONT><FONT SIZE=2><B>CRC</B></FONT><FONT SIZE=2><B>_</B></FONT><FONT SIZE=2><B>ERROR</B></FONT><FONT SIZE=2><B>
</B></FONT><FONT SIZE=2>в</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>статусе</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>канала</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>чтобы</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>пользовательское</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>приложение</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>могло</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>обработать</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>эту</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>ситуацию</FONT><FONT SIZE=2>.
</FONT>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Кроме того, из &ldquo;не используемых&rdquo; на
канальном уровне размеров кадра (как нулевой) есть ещё длины 1 и 2
байта., которые могут быть использованы как ACK и NACK сигналы
передающей стороне при без ошибочной либо не совпадающей контрольной
сумме кадра соответственно. Это освободит пользовательское приложение
от необходимости обрабатывать случаи приёма &ldquo;битых&rdquo;
кадров.</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%">
<B>2.2 FEED ADDRESS PROTOCOL</B></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Протокол верхнего </FONT><FONT SIZE=2><U>транспортного</U></FONT><FONT SIZE=2>
уровня в двухуровневой модели связи фид-канала. Определяет
интерфейс-получатель фид фрейма. На его уровне выполняются задачи:</FONT></P>
<OL>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Определение</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>разрядности</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>адреса</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>интерфейса</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>устройства</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Определение</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>адреса</FONT><FONT SIZE=2>
	</FONT><FONT SIZE=2>интерфейса</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>устройства</FONT></P>
	<LI><P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Определение запрошенной операции над интерфейсом
	(Чтение / Запись) устройства. </FONT>
	</P>
	<P ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 115%; widows: 2; orphans: 2; page-break-before: auto; page-break-after: auto">
	<FONT SIZE=2>Протокол допускает два вида разрядности адреса
	интерфейса, 8 и 31 битный адреса. </FONT><FONT SIZE=2><B>Разрядность</B></FONT><FONT SIZE=2>
	адреса интерфейса определяется по длине данных фид фрейма. Возможны
	5 вариантов результата определения адреса и последующих операций над
	интерфейсом устройства:</FONT></P>
</OL>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>0 </FONT><FONT SIZE=2>длинна</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>фрейма</FONT><FONT SIZE=2> - </FONT><FONT SIZE=2><U>не</U></FONT><FONT SIZE=2><U>
</U></FONT><FONT SIZE=2><U>обрабатывается</U></FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>1 </FONT><FONT SIZE=2>байт</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2>
- </FONT><FONT SIZE=2>операция</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>чтения</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>одного</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>байта</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>с</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>указанного</FONT><FONT SIZE=2>
8 </FONT><FONT SIZE=2>битного</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>адреса</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>интерфейса</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>2 </FONT><FONT SIZE=2>байта</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2>
- </FONT><FONT SIZE=2>операция</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>записи</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>одного</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>байта</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>по</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>указанному</FONT><FONT SIZE=2>
8 </FONT><FONT SIZE=2>битному</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>адресу</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>интерфейса</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>3 </FONT><FONT SIZE=2>байта</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>данных</FONT><FONT SIZE=2>
- </FONT><FONT SIZE=2>контроль</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>протокола</FONT><FONT SIZE=2>,
</FONT><FONT SIZE=2><U>зарезервировано</U></FONT><FONT SIZE=2>, </FONT><FONT SIZE=2>на</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>данный</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>момент</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>не</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>используется</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>4 и более байт - чтение/запись по указанному 31 битному
адресу интерфейса</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2><B>Адреса</B></FONT><FONT SIZE=2> </FONT><FONT SIZE=2>интерфейсов</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>свободно</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>определяются</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>пользователем</FONT><FONT SIZE=2> (</FONT><FONT SIZE=2>разработчиком</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>устройства</FONT><FONT SIZE=2>). </FONT><FONT SIZE=2>Но</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>для</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>большей</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>информативности</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>и</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>возможности</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>обращаться</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>к</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>адресам</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>интерфейсов</FONT><FONT SIZE=2>  </FONT><FONT SIZE=2>посредством</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>символьных</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>терминалов</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>рекомендуется</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>выбирать</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>адреса</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>имеющие</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>хорошее</FONT><FONT SIZE=2> (</FONT><FONT SIZE=2>человеческое</FONT><FONT SIZE=2>)
</FONT><FONT SIZE=2>символьное</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>представление</FONT><FONT SIZE=2>.
</FONT>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Примеры адресов интерфейсов и запросы к ним (dwsfeed.h):</FONT></P>
<div class="highlight highlight-c++"><pre><span class="pl-c">/*** DWord Strings defines ***/</span>
<span class="pl-c">/* interfaces */</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsDEV</span>      0x3E564544    <span class="pl-c">// DEV&gt; DEVice [common] interface</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsMCU</span>      0x3E55434D    <span class="pl-c">// MCU&gt; MicroController Unit [main in device] interface</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsMCU0</span>     0x3055434D
#<span class="pl-k">define</span> <span class="pl-en">dwsMCU1</span>     0x3155434D
#<span class="pl-k">define</span> <span class="pl-en">dwsMCU2</span>     0x3255434D
#<span class="pl-k">define</span> <span class="pl-en">dwsMCU3</span>     0x3355434D
#<span class="pl-k">define</span> <span class="pl-en">dwsCPU</span>      0x3E555043    <span class="pl-c">// CPU&gt; Central Processing Unit [main in device MCU's kernel]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsRAM</span>      0x3E4D4152    <span class="pl-c">// abstract RAM&gt; [Random-Access Memory] interface of device</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsROM</span>      0x3E4D4F52    <span class="pl-c">// abstract ROM&gt; [Read-Only Memory] interface of device</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsMEM</span>      0x3E4D454D    <span class="pl-c">// abstract MEM&gt; [memory] interface of device</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsFILE</span>     0x454C4946    <span class="pl-c">// abstract FILE interface of device</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsDATA</span>     0x41544144    <span class="pl-c">// abstract DATA interface of device</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsLOOP</span>     0x504F4F4C    <span class="pl-c">// LOOP-back received messages</span>
<span class="pl-c">/* requests */</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsNAME</span>     0x454D414E    <span class="pl-c">// NAME [any]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsINFO</span>     0x4F464E49    <span class="pl-c">// INFOrmation</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsVERS</span>     0x53524556    <span class="pl-c">// VERSion</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsMODL</span>     0x4C444F4D    <span class="pl-c">// MODeL</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsTXDY</span>     0x59445854    <span class="pl-c">// TX DelaY</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsPROG</span>     0x474F5250    <span class="pl-c">// PROGramming</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsBINX</span>     0x584E4942    <span class="pl-c">// BINX data header</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsREPT</span>     0x54504552    <span class="pl-c">// REPeaT</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsREG</span>      0x3E474552    <span class="pl-c">// REGister [mcu/device]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsPORT</span>     0x54524F50    <span class="pl-c">// PORT [mcu/device]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsADDR</span>     0x52444441    <span class="pl-c">// ADDRess [mcu/device]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsSTAT</span>     0x54415453    <span class="pl-c">// STATe / STATus [any]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsECHO</span>     0x4F484345    <span class="pl-c">// ECHO [for any interface present]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsALOC</span>     0x434F4C41    <span class="pl-c">// AlLOCate [memory]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsFREE</span>     0x45455246    <span class="pl-c">// FREE [memory]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsUSER</span>     0x52455355    <span class="pl-c">// USER name</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsAUTH</span>     0x48545541    <span class="pl-c">// AUTHorization [means process phase]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsPSW</span>      0x3E575350    <span class="pl-c">// PSW&gt; PaSsWord [input password]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsSESS</span>     0x53534553    <span class="pl-c">// SESSion [for current user]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsNIRQ</span>     0x5152494E    <span class="pl-c">// InterRupt Query [query state irq pin]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsTEST</span>     0x54534554    <span class="pl-c">// TEST [any]</span>
#<span class="pl-k">define</span> <span class="pl-en">dwsBOOT</span>     0x544F4F42    <span class="pl-c">// BOOTing / re-BOOTing</span></pre></div>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2><B>Операция</B></FONT><FONT SIZE=2><B> </B></FONT><FONT SIZE=2>(</FONT><FONT SIZE=2>чтение</FONT><FONT SIZE=2>
/ </FONT><FONT SIZE=2>запись</FONT><FONT SIZE=2>), </FONT><FONT SIZE=2>которую</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>требуется</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>произвести</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>с</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>адресуемым</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>интерфейсом</FONT><FONT SIZE=2>, </FONT><FONT SIZE=2>определяется</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>старшим</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>битом</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>в</FONT><FONT SIZE=2> 32 </FONT><FONT SIZE=2>разрядном</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>поле</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>заголовка</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>адресного</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>протокола</FONT><FONT SIZE=2>.</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT COLOR="#000000"><IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/FAP32_readwrite.png"></FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT COLOR="#000000"><IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/FAP8_readwrite.png"></FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Процесс передачи данных от приложения хоста к интерфейсу
устройства и обратно:</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/FeedBuffers.png"></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Устройство</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>ядра</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>USB</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>модуля</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>STM</FONT><FONT SIZE=2>32</FONT><FONT SIZE=2>F</FONT><FONT SIZE=2>10</FONT><FONT SIZE=2>x</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/RM0008_USB_Core.png"></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<FONT SIZE=2>Для</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>тестирования</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>FEED</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>драйвера</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>использовалась</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>отладочная</FONT><FONT SIZE=2>
</FONT><FONT SIZE=2>плата</FONT><FONT SIZE=2> </FONT><FONT SIZE=2>OLIMEXINO</FONT><FONT SIZE=2>-</FONT><FONT SIZE=2>STM</FONT><FONT SIZE=2>32
&lt;</FONT><FONT SIZE=2>STM</FONT><FONT SIZE=2>32</FONT><FONT SIZE=2>F</FONT><FONT SIZE=2>103</FONT><FONT SIZE=2>RBT</FONT><FONT SIZE=2>6&gt;</FONT></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/OLIMEXINOSTM32_view.jpg"></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/OLIMEXINOSTM32_schem.png"></P>
<H3 STYLE="text-indent: 0.98cm; line-height: 115%; page-break-before: auto; page-break-after: auto"><A NAME="h.s0q7anajfdgk"></A>
4. Тест терминал</H3>
<P STYLE="margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/TestTerminalQt.png"></P>
<P>
<IMG SRC="https://raw.githubusercontent.com/JohnMcLaren/USBFeedDriver/master/img/devicestree.PNG"></P>
<P STYLE="text-indent: 0.98cm; margin-bottom: 0cm; line-height: 115%; page-break-before: auto; page-break-after: auto">
<BR>
</P>
      </section>
    </div>
    <footer>
      <p>Project maintained by <a href="https://github.com/JohnMcLaren">JohnMcLaren</a></p>
      <p>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-58686535-2");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
